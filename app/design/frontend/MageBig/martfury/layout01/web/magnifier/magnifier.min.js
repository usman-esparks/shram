!function(z){function e(n,e){var s,b=e||{},r=z(n),t=this,i=e.largeWrapper||".magnifier-preview",o=z(i);curThumb=null,magnifierOptions={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,zoomMin:1.1,zoomMax:5,mode:"outside",eventType:"click",status:0,zoomAttached:!1,zoomable:void 0!==b.zoomable&&b.zoomable,onthumbenter:void 0!==b.onthumbenter?b.onthumbenter:null,onthumbmove:void 0!==b.onthumbmove?b.onthumbmove:null,onthumbleave:void 0!==b.onthumbleave?b.onthumbleave:null,onzoom:void 0!==b.onzoom?b.onzoom:null},pos={t:0,l:0,x:0,y:0},gId=0,status=0,curIdx="",curLens=null,curLarge=null,lensbg=void 0===b.bg||b.lensbg,gZoom=void 0!==b.zoom?b.zoom:magnifierOptions.zoom,gZoomMin=void 0!==b.zoomMin?b.zoomMin:magnifierOptions.zoomMin,gZoomMax=void 0!==b.zoomMax?b.zoomMax:magnifierOptions.zoomMax,gMode=b.mode||magnifierOptions.mode,gEventType=b.eventType||magnifierOptions.eventType,data={},inBounds=!1,isOverThumb=!1,rate=1,paddingX=0,paddingY=0,enabled=!0,showWrapper=!0;var m={magnifyHidden:"magnify-hidden",magnifyOpaque:"magnify-opaque",magnifyFull:"magnify-fullimage"};function g(n){if("string"==typeof n){if("true"===n)return!0;if("false"===n)return!1;console.warn("Wrong type: can't be transformed to Boolean")}else if("boolean"==typeof n)return n}function O(n,e,i,a){var t,o=r.find(".magnify-lens");1===data[n].status?(t=z('<div class="magnifier-loader-text"></div>'),o.className="magnifier-loader magnify-hidden",t.html("Loading..."),o.html("").append(t)):2===data[n].status&&(o.addClass(m.magnifyHidden),o.html(""),i.id=n+"-large",i.style.width=data[n].largeImgInMagnifyLensWidth+"px",i.style.height=data[n].largeImgInMagnifyLensHeight+"px",i.className="magnifier-large magnify-hidden","inside"===data[n].mode?o.append(i):a.html("").append(i)),data[n].lensH=data[n].lensH>s.height()?s.height():data[n].lensH,0===Math.round(data[n].lensW)?o.css("display","none"):o.css({width:Math.round(data[n].lensW)+"px",height:Math.round(data[n].lensH)+"px",display:""})}function a(){var n,e,i=pos.x-magnifierOptions.x,a=pos.y-magnifierOptions.y;inBounds=!(i<0||a<0||i>magnifierOptions.w||a>magnifierOptions.h),e=i-magnifierOptions.lensW/2,n=a-magnifierOptions.lensH/2,i<magnifierOptions.lensW/2&&(e=0),a<magnifierOptions.lensH/2&&(n=0),0<i-magnifierOptions.w+Math.ceil(magnifierOptions.lensW/2)&&(e=magnifierOptions.w-Math.ceil(magnifierOptions.lensW+2)),0<a-magnifierOptions.h+Math.ceil(magnifierOptions.lensH/2)&&(n=magnifierOptions.h-Math.ceil(magnifierOptions.lensH)),pos.l=e,pos.t=n,magnifierOptions.lensBgX=pos.l,magnifierOptions.lensBgY=pos.t,"inside"===magnifierOptions.mode?(magnifierOptions.largeL=Math.round(i*(magnifierOptions.zoom-magnifierOptions.lensW/magnifierOptions.w)),magnifierOptions.largeT=Math.round(a*(magnifierOptions.zoom-magnifierOptions.lensH/magnifierOptions.h))):(magnifierOptions.largeL=Math.round(magnifierOptions.lensBgX*magnifierOptions.zoom*(magnifierOptions.largeWrapperW/magnifierOptions.w)),magnifierOptions.largeT=Math.round(magnifierOptions.lensBgY*magnifierOptions.zoom*(magnifierOptions.largeWrapperH/magnifierOptions.h)))}function l(){g(enabled)&&(magnifierOptions=data[curIdx],curLens=r.find(".magnify-lens"),2===magnifierOptions.status?(curLens.removeClass(m.magnifyOpaque),curLarge=z("#"+curIdx+"-large"),curLarge.removeClass(m.magnifyHidden)):1===magnifierOptions.status&&(curLens.className="magnifier-loader"))}function y(){if(0<magnifierOptions.status){var n=magnifierOptions.onthumbleave;null!==n&&n({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y}),curLens.hasClass(m.magnifyHidden)||(curLens.addClass(m.magnifyHidden),null!==curLarge&&curLarge.addClass(m.magnifyHidden))}}function u(){if(g(enabled)){if(status!==magnifierOptions.status&&l(),0<magnifierOptions.status){curThumb.className=magnifierOptions.thumbCssClass+" magnify-opaque",1===magnifierOptions.status?curLens.className="magnifier-loader":2===magnifierOptions.status&&(curLens.removeClass(m.magnifyHidden),curLarge.removeClass(m.magnifyHidden),curLarge.css({left:"-"+magnifierOptions.largeL+"px",top:"-"+magnifierOptions.largeT+"px"}));pos.t=pos.t<=0?0:pos.t-2,curLens.css({left:pos.l+paddingX+"px",top:pos.t+paddingY+"px"}),lensbg?curLens.css({"background-color":"rgba(f,f,f,.5)"}):curLens.get(0).style.backgroundPosition="-"+magnifierOptions.lensBgX+"px -"+magnifierOptions.lensBgY+"px";var n=magnifierOptions.onthumbmove;null!==n&&n({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y})}status=magnifierOptions.status}}function x(n,e){var i=n.getBoundingClientRect(),a=0,t=0;e.x=Math.round(i.left),e.y=Math.round(i.top),e.w=Math.round(i.right-e.x),e.h=Math.round(i.bottom-e.y),t="inside"===e.mode?(a=e.w,e.h):(a=e.largeWrapperW,e.largeWrapperH),e.largeImgInMagnifyLensWidth=Math.round(e.zoom*a),e.largeImgInMagnifyLensHeight=Math.round(e.zoom*t),e.lensW=Math.round(e.w/e.zoom),e.lensH=Math.round(e.h/e.zoom)}function d(n,e){var i={};if(void 0===e.thumb)return!1;if((s=n.find(e.thumb)).length){for(var a in e)i[a]=e[a];i.thumb=s,enabled=i.enabled,g(enabled)?(o.show().css("display",""),o.addClass(m.magnifyHidden),function(n){if(void 0!==data[n.thumb.id])return curThumb=n.thumb;var e,i=new Image,a=new Image,t=n.thumb,o=t.get(0),s=o.id,r=z(n.largeWrapper),m=n.zoom||o.getAttribute("data-zoom")||gZoom,g=n.zoomMin||gZoomMin,l=n.zoomMax||gZoomMax,u=n.mode||o.getAttribute("data-mode")||gMode,d=n.eventType||o.getAttribute("data-eventType")||gEventType,p=void 0!==n.onthumbenter?n.onthumbenter:magnifierOptions.onthumbenter,f=void 0!==n.onthumbleave?n.onthumbleave:magnifierOptions.onthumbleave,h=void 0!==n.onthumbmove?n.onthumbmove:magnifierOptions.onthumbmove;e=t.data("original")||b.full||t.attr("src"),""===o.id&&(s=o.id="magnifier-item-"+gId,gId+=1);(function(n){if(z(n).siblings(".magnify-lens").length)return;var e=z('<div class="magnify-lens magnify-hidden" data-gallery-role="magnifier-zoom"></div>');z(n).parent().append(e)})(o),n.width&&r.width(n.width);n.height&&r.height(n.height);if(n.top){if("function"==typeof n.top)var c=n.top()+"px";else c=n.top+"px";r.length&&(r[0].style.top=c.replace("%px","%"))}if(n.left){if("function"==typeof n.left)var v=n.left()+"px";else v=n.left+"px";r.length&&(r[0].style.left=v.replace("%px","%"))}data[s]={zoom:m,zoomMin:g,zoomMax:l,mode:u,eventType:d,thumbCssClass:o.className,zoomAttached:!1,status:0,largeUrl:e,largeWrapperId:"outside"===u?r.attr("id"):null,largeWrapperW:"outside"===u?r.width():null,largeWrapperH:"outside"===u?r.height():null,onthumbenter:p,onthumbleave:f,onthumbmove:h},paddingX=(t.parent().width()-t.width())/2,paddingY=(t.parent().height()-t.height())/2,showWrapper=!1,z(i).on("load",function(){data[s].status=1,z(a).on("load",function(){(a.width>r.width()||a.height>r.height())&&(showWrapper=!0,function(n,e){switch(n){case"hover":!function(n){z(n).on("mouseover",function(n){showWrapper&&(0!==magnifierOptions.status&&y(),M(n),isOverThumb=inBounds)}).trigger("mouseover")}(e);break;case"click":!function(n){z(n).on("click",function(n){showWrapper&&(isOverThumb||(0!==magnifierOptions.status&&y(),M(n),isOverThumb=!0))})}(e)}}(d,o),data[s].status=2,a.width>a.height?data[s].zoom=a.width/r.width():data[s].zoom=a.height/r.height(),x(o,data[s]),O(s,0,a,r))}),a.src=data[s].largeUrl}),i.src=o.src}(i)):o.empty().hide()}return t}function M(n){var e=n.target;curIdx=e.id,curThumb=e,l(),x(curThumb,magnifierOptions),pos.x=n.clientX,pos.y=n.clientY,a(),u();var i=magnifierOptions.onthumbenter;null!==i&&i({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y})}t.update=function(){O()},t.init=function(){d(r,e)},z(window).on("scroll",function(){null!==curThumb&&x(curThumb,magnifierOptions)}),z(window).resize(function(){d(r,b)}),r.on("mousemove",function(n){pos.x=n.clientX,pos.y=n.clientY,a(),"hover"===gEventType&&(isOverThumb=inBounds),inBounds&&isOverThumb&&"outside"===gMode&&(o.removeClass(m.magnifyHidden),u())}),r.on("mouseleave",function(){y(),isOverThumb=!1,o.addClass(m.magnifyHidden)}),d(r,b)}z.fn.magnify=function(n){"use strict";return new e(z(this),n)}}(jQuery);